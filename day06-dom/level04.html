<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>点击获取随机笑话 | 实战练习</title>
    <style>
        /* 简单样式：让页面更美观，适配移动端 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Arial", "微软雅黑", sans-serif;
        }
        body {
            max-width: 800px;
            margin: 50px auto;
            padding: 0 20px;
            text-align: center;
        }
        h1 {
            color: #2c3e50;
            margin-bottom: 30px;
        }
        /* 按钮样式 */
        #jokeBtn {
            padding: 12px 30px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        #jokeBtn:hover {
            background-color: #2980b9;
        }
        /* 加载状态样式 */
        #loading {
            margin: 20px 0;
            color: #7f8c8d;
            font-size: 14px;
            display: none; /* 默认隐藏 */
        }
        /* 笑话显示区域样式 */
        #jokeContainer {
            margin-top: 30px;
            padding: 25px;
            background-color: #f8f9fa;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: left;
        }
        /* 错误提示样式 */
        .error {
            color: #e74c3c;
        }
    </style>
</head>
<body>
    <h1>随机笑话生成器</h1>
    <!-- 触发按钮 -->
    <button id="jokeBtn">点击获取一条笑话</button>
    <!-- 加载状态提示 -->
    <div id="loading">正在加载笑话...</div>
    <!-- 笑话显示容器 -->
    <div id="jokeContainer">点击上方按钮，获取随机笑话吧！</div>

    <script>
        // 1. 获取页面元素（按钮、加载状态、笑话容器）
        const jokeBtn = document.getElementById('jokeBtn');
        const loading = document.getElementById('loading');
        const jokeContainer = document.getElementById('jokeContainer');

        // 2. 定义「获取笑话」的核心函数（异步函数，因为要发网络请求）
        async function getRandomJoke() {
            try {
                // 显示加载状态，隐藏旧内容
                loading.style.display = 'block';
                jokeContainer.innerHTML = '';
                jokeContainer.classList.remove('error'); // 清除之前的错误样式

                // 3. 发送请求到「免费笑话 API」（无需密钥，支持跨域）
                // 接口说明：返回随机英文笑话，结构为 { id: 123, joke: "笑话内容" }
                const response = await fetch('https://official-joke-api.appspot.com/jokes/random');
                
                // 4. 检查请求是否成功（状态码 200-299 为成功）
                if (!response.ok) {
                    throw new Error(`请求失败，状态码：${response.status}`);
                }

                // 5. 解析返回的 JSON 数据
                const jokeData = await response.json();
                console.log('获取到的笑话数据：', jokeData); // 控制台查看数据结构

                // 6. 将笑话显示到页面
                jokeContainer.innerHTML = `<p>${jokeData.setup}</p>-<p><em>${jokeData.punchline}</em></p>`;

            } catch (error) {
                // 7. 错误处理：网络问题、接口故障时显示提示
                jokeContainer.innerHTML = `<p>获取笑话失败：${error.message}</p>`;
                jokeContainer.classList.add('error'); // 添加错误样式（红色文字）
                console.error('错误详情：', error); // 控制台打印错误，方便调试

            } finally {
                // 8. 无论成功/失败，最终隐藏加载状态
                loading.style.display = 'none';
            }
        }

        // 9. 给按钮添加点击事件：点击时调用「获取笑话」函数
        jokeBtn.addEventListener('click', getRandomJoke);
    </script>
</body>
</html>