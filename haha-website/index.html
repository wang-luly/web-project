<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>Fetch 实战练习模板</title>
    <style>
        .container { max-width: 800px; margin: 20px auto; padding: 0 20px; }
        .btn { padding: 8px 16px; cursor: pointer; margin-right: 10px; }
        .loading { color: #666; display: none; }
        .error { color: #dc3545; }
        .data-list { margin-top: 20px; padding-left: 0; list-style: none; }
        .data-list li { padding: 10px; border-bottom: 1px solid #eee; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Fetch 练习面板</h1>
        <button class="btn" id="btnBasic">1. 基础调用（打印JSON）</button>
        <button class="btn" id="btnError">2. 错误处理（404/网络错）</button>
        <button class="btn" id="btnRender">3. 数据渲染（展示到页面）</button>
        
        <div class="loading" id="loading">加载中...</div>  
        <div class="error" id="errorMsg"></div>
        <ul class="data-list" id="dataList"></ul>
    </div>
<!-- 猫咪小知识：https://catfact.ninja/fact -->
 <!--不存在的接口： https://jsonplaceholder.typicode.com/invalid-url-404 -->
 <!--帖子列表： https://jsonplaceholder.typicode.com/posts?_limit=1 -->
    <script>
        // 公共元素获取
        const loading=document.getElementById('loading');
        const errorMsg=document.getElementById('errorMsg');
        const dataList=document.getElementById('dataList');

        // 公共函数：重置页面状态（每次请求前清空之前的内容和提示）
        function resetPage(){
            errorMsg.textContent='';
            dataList.innerHTMl='';
        }

        // 1. 基础调用：用 Fetch 获取数据并在控制台打印 JSON
        document.getElementById('btnBasic').addEventListener('click',async()=>{
            resetPage();
            loading.style.display='block';
            try{
                const response=await fetch('https://catfact.ninja/fact');
                if(!response.ok){
                    throw new Error(`http错误！状态码:${response.status}`);
                }
                const data=await response.json();
                console.log('基础调用--接口返回数据:',data);
                alert(`获取到猫咪的小知识：${data.fact}`);
            }catch(error){
                console.error('基础调用--请求失败：',error);
                errorMsg.textContent='获取数据失败，请查看控制台错误信息';
            }finally{
                loading.style.display='none';
            }
        })

           

        // 2. 错误处理：模拟 404 和网络错误，手动处理不同异常
        

        // 3. 数据渲染：获取列表数据并动态展示到 HTML 页面
        document.getElementById('btnRender').addEventListener('click', async () => {
            resetState();
            loading.style.display = 'block';

            try {
                // 调用 JSONPlaceholder 的“帖子列表”接口（返回 100 条数据）
                const response = await fetch('https://jsonplaceholder.typicode.com/posts?_limit=10'); // _limit=10 限制只返回10条
                if (!response.ok) {
                    throw new Error(`请求失败，状态码：${response.status}`);
                }
                const posts = await response.json(); // posts 是一个数组
                
                // 遍历数组，动态创建 li 标签，添加到页面
                posts.forEach(post => {
                    const li = document.createElement('li');
                    // 设置 li 的内容（标题 + 内容）
                    li.innerHTML = `
                        <strong>标题：${post.title}</strong>
                        <p>内容：${post.body}</p>
                    `;
                    dataList.appendChild(li); // 把 li 加到列表中
                });

                console.log('数据渲染 - 帖子列表：', posts);
            } catch (error) {
                console.error('数据渲染 - 出错了：', error);
                errorMsg.textContent = `加载帖子失败：${error.message}`;
            } finally {
                loading.style.display = 'none';
            }
        });
        
    </script>
</body>
</html>